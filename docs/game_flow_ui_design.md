# 掼蛋游戏 - 核心流程与界面设计需求文档

**文档版本**: v1.0  
**更新日期**: 2025年12月12日  
**适用平台**: Web + 手机版 (iOS/Android)  
**设计范围**: 游戏房间、游戏进行、结算等核心流程  

---

## 1. 游戏流程总览

### 1.1 完整用户旅程

```
大厅页面
  ↓
快速匹配 / 创建房间
  ↓
房间等待页
  ├─ 玩家准备 (倒计时10秒)
  ↓
游戏开始
  ├─ 发牌动画
  ├─ 玩家准备确认
  ↓
游戏进行中 (核心)
  ├─ 出牌阶段 (循环)
  │  ├─ 玩家A出牌
  │  ├─ 玩家B选择: 压牌 or 过牌
  │  ├─ 玩家C选择: 压牌 or 过牌
  │  └─ 玩家D选择: 压牌 or 过牌
  ├─ 一轮结束
  ├─ 继续出牌或接风
  └─ 重复直到有人出完所有牌
  ↓
游戏结束 (结算)
  ├─ 排名确定 (头游、二游、三游、末游)
  ├─ 进贡/还贡动画
  ├─ 金币计算与显示
  ├─ 升级提示
  ↓
游戏统计页
  ├─ 本局数据展示
  ├─ "再来一局" 或 "返回大厅"
  ↓
大厅
```

---

## 2. 游戏房间页面设计

### 2.1 房间等待页 (Ready Screen)

#### 2.1.1 Web 版设计

```
╔════════════════════════════════════════════════════════════╗
║              房间号: 123456  │ 底注: 20金币 × 局数:1        ║
╠════════════════════════════════════════════════════════════╣
║                                                            ║
║          玩家1 (房主)              玩家2                  ║
║     ┌──────────────┐          ┌──────────────┐           ║
║     │              │          │              │           ║
║     │ 🥇 Lv.15    │          │ 🥈 Lv.12    │           ║
║     │ 💰 90,000   │          │ 💰 45,000   │           ║
║     │              │          │              │           ║
║     │  [已准备]    │          │  [等待中]    │           ║
║     └──────────────┘          └──────────────┘           ║
║                                                            ║
║          玩家3                  玩家4 (你)               ║
║     ┌──────────────┐          ┌──────────────┐           ║
║     │              │          │              │           ║
║     │ 🥉 Lv.10    │          │ ⭐ Lv.14    │           ║
║     │ 💰 32,000   │          │ 💰 120,000  │           ║
║     │              │          │              │           ║
║     │  [准备中]    │          │ [确认准备]   │           ║
║     └──────────────┘          └──────────────┘           ║
║                                                            ║
║  倒计时: 10秒 ████████░░ (进度条)                         ║
║                                                            ║
║              [确认准备]  [邀请好友]  [返回大厅]             ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**元素说明**:

| 元素 | 说明 | 功能 |
|------|------|------|
| **房间号** | 6位数字，便于分享 | 点击复制房间号 |
| **底注** | 本局单位金币 | 显示参数 |
| **局数** | 本房间总局数 | 显示参数 |
| **玩家卡片** | 头像、昵称、等级、金币 | 悬停显示玩家详情 |
| **准备状态** | [已准备] / [等待中] / [准备中] | 实时同步 |
| **倒计时** | 10秒进度条 | 动画进度 |
| **按钮** | 确认、邀请、返回 | 可交互 |

**交互设计**:
- [ ] 玩家点击 [确认准备] → 状态变为 [已准备]
- [ ] 所有人准备完毕 → 自动倒计时 10秒
- [ ] 10秒后自动开始游戏
- [ ] 玩家可在倒计时时取消准备
- [ ] [邀请好友] 弹出分享窗口 (房间号+链接)
- [ ] [返回大厅] 需要二次确认

#### 2.1.2 手机版设计 (纵向布局)

```
┌────────────────────────────────┐
│ ← 房间号:123456               │
├────────────────────────────────┤
│                                │
│    玩家1 (房主)   玩家2        │
│  ┌─────────┐  ┌─────────┐     │
│  │ 🥇Lv15 │  │ 🥈Lv12 │     │
│  │ 90,000 │  │ 45,000 │     │
│  │ [已准备]│  │ [等待] │     │
│  └─────────┘  └─────────┘     │
│                                │
│    玩家3        玩家4 (你)     │
│  ┌─────────┐  ┌─────────┐     │
│  │ 🥉Lv10 │  │ ⭐Lv14 │     │
│  │ 32,000 │  │ 120,000│     │
│  │ [准备中]│  │[确认准备]│    │
│  └─────────┘  └─────────┘     │
│                                │
│  倒计时: 10秒 ███████░░░       │
│                                │
│ 底注: 20 × 1局                │
│                                │
│ [确认准备]  [邀请]  [返回]     │
│                                │
└────────────────────────────────┘
```

**手机版特殊设计**:
- [ ] 4个玩家卡片用2×2网格排列
- [ ] 卡片按 [你的位置] 放在右下角
- [ ] 字体大小优化 (≥14px)
- [ ] 按钮宽度 >44px (易于点击)
- [ ] 卡片点击 → 显示玩家详细资料 (模态框)

---

## 3. 游戏进行中 - 核心界面设计

### 3.1 Web 版 - 游戏进行界面

#### 3.1.1 完整布局

```
╔════════════════════════════════════════════════════════════════╗
║                        【 掼蛋游戏进行中 】                    ║
║  房间: 123456  底注: 20  第1局/3局  本轮首先: 玩家1            ║
╠════════════════════════════════════════════════════════════════╣
║                                                                ║
║    玩家2 (对手1)              玩家3 (对手2)                   ║
║  ┌──────────────┐  剩余: 8张  ┌──────────────┐               ║
║  │ 🥈 Lv.12     │             │ 🥉 Lv.10     │               ║
║  │ 一对 Q       │             │ 已出: 3组    │               ║
║  │ 剩余: 11张   │             │ 已过: 2次    │               ║
║  └──────────────┘             └──────────────┘               ║
║           △                                 △                 ║
║           │                                 │                 ║
║           └─────────────────┬───────────────┘                 ║
║                             │                                 ║
║  ┌────────────────────────────────────────────────────────┐  ║
║  │                    当前出牌 (玩家1)                    │  ║
║  │                                                        │  ║
║  │              ♠ ♠ ♠ ♠ ♠                              │  ║
║  │              3 4 5 6 7  (顺子)                        │  ║
║  │                                                        │  ║
║  │  上家已出: [玩家1 出顺子] 已过: [玩家2]  [玩家3]    │  ║
║  │  现在轮到: 玩家4 (你) 选择...                        │  ║
║  └────────────────────────────────────────────────────────┘  ║
║           △                                 △                 ║
║           │                                 │                 ║
║  ┌──────────────┐             ┌──────────────┐               ║
║  │ 玩家1(房主)  │             │  玩家4 (你)  │               ║
║  │ 🥇 Lv.15    │             │ ⭐ Lv.14     │               ║
║  │ 已出: 5组    │             │ 剩余: 12张   │               ║
║  │ 已过: 0次    │             │ 金币: 120k   │               ║
║  └──────────────┘             └──────────────┘               ║
║                                                                ║
║  你的手牌 (12张):                                             ║
║  ♠A ♥K ♠Q ♠J ♠10 ♠9 ♠8 ♠7 ♠6 ♠5 ♣4 ♦3               ║
║  [长按查看牌点]                                               ║
║                                                                ║
║           [压牌]  (更大的顺子)    [过牌]                      ║
║           [提示]                  [快速表情]                   ║
║                                                                ║
║  出牌倒计时: 20秒 ██████████░░░░░░░░ 剩余时间: 20s           ║
║                                                                ║
╚════════════════════════════════════════════════════════════════╝
```

#### 3.1.2 详细元素说明

**顶部信息栏**:
```
房间号 | 底注 | 局数进度 | 当前首先出牌者
123456 | 20  | 第1/3局  | 玩家1 (🔴 正在出牌)
```

**玩家位置** (四角):
```
左上 (玩家2)          右上 (玩家3)
  ┌─────┐            ┌─────┐
  │ Lv12│            │ Lv10│
  │ 11张│            │ 8张 │
  └─────┘            └─────┘

左下 (玩家1)          右下 (玩家4/你)
  ┌─────┐            ┌─────┐
  │ Lv15│            │ Lv14│
  │ 9张 │            │ 12张│ ← 高亮显示
  └─────┘            └─────┘
```

**中央牌面区** (关键区域):

```
当前出牌: 玩家1 (出顺子)
显示的牌: ♠3 ♠4 ♠5 ♠6 ♠7 (清晰大图)

历史记录:
  玩家2: 过
  玩家3: 过
  
现在轮到: 玩家4 (你) [60% 透明化其他区域] ← 视觉焦点
```

**你的手牌区** (下方):

```
╔═══════════════════════════════════════════════╗
║ 你的手牌 (按牌点自动分类) - 12张总计          ║
├───────────────────────────────────────────────┤
║                                               ║
║  ♠ 黑桃区: A K Q J 10 9 8 7 6              ║
║                                               ║
║  ♥ 红桃区: K 5 3                            ║
║                                               ║
║  ♣ 梅花区: 4                                ║
║                                               ║
║  ♦ 方块区: 3                                ║
║                                               ║
║  🃏 王牌: 小王 × 1                          ║
║                                               ║
║ [长按卡片显示牌点数值]                       ║
╚═══════════════════════════════════════════════╝

交互:
- 点击手牌 → 选中/取消 (变色+向上移动)
- 双击手牌 → 快速确认出牌
- 长按手牌 → 放大显示
```

**操作按钮区**:

```
┌──────────────────────────────────┐
│                                  │
│  [压牌]          [提示]          │
│ (蓝色,可用)   (灰色,仅建议)     │
│                                  │
│  [过牌]          [快速表情]      │
│ (红色,警告)    (表情选择器)     │
│                                  │
│ 出牌倒计时: 25秒 ████████░░░░   │
│            (红色进度条)          │
│                                  │
└──────────────────────────────────┘
```

**按钮状态逻辑**:

| 按钮 | 你可出牌 | 无法出牌 | 交互 |
|------|---------|---------|------|
| **压牌** | 蓝色可用 | 灰色禁用 | 点击 → 出牌验证 |
| **过牌** | 红色可用 | 灰色禁用 | 点击 → 即刻过牌 |
| **提示** | 蓝色 | 灰色 | 点击 → 推荐出牌 |
| **表情** | 绿色 | 绿色 | 点击 → 快速回应 |

**倒计时设计**:

```
出牌倒计时 (30秒)

30-20秒: 绿色进度条 ████████░░░░░░░░░░ (正常)
20-10秒: 黄色进度条 ████░░░░░░░░░░░░░░░░ (警告)
10-0秒:  红色进度条 ░░░░░░░░░░░░░░░░░░░░ (紧急)

5秒倒计时: 显示数字 "5 4 3 2 1" 并闪烁
0秒: 自动过牌，弹窗提示 "你已过牌"
```

#### 3.1.3 游戏中的关键交互

**1. 选牌与出牌**

```
场景: 你要出 5-6-7-8-9 的顺子

步骤1: 在手牌中找到这5张牌
  ↓
步骤2: 点击5张牌 → 卡片向上移动并高亮
  ↓
步骤3: 点击 [压牌] 按钮
  ↓
步骤4: 系统验证 (是否有效的顺子)
  ↓
步骤5: 验证通过 → 动画显示出牌
  ↓
步骤6: 出牌成功 → 轮到下一个玩家
```

**验证失败提示**:
```
❌ 提示: 这5张牌无法组成有效的顺子
   检查: 你选了 5♠ 6♠ 7♠ 8♠ 10♠ (缺9♠)
   建议: 点击 [提示] 获得推荐出牌
```

**2. 使用逢人配**

```
主牌: 5 (红桃5两张为逢人配)
手牌: 3♠ 4♠ 红♥5 6♠ 7♠

想出: 3-4-5-6-7 顺子

操作:
  1. 点击 3♠ 4♠ 红♥5 6♠ 7♠ (共5张)
  2. 系统识别: 红♥5 作为逢人配代替了黑♠5
  3. 显示提示: "使用逢人配代替黑桃5"
  4. 点击 [压牌] 确认
```

**3. 过牌**

```
场景: 你压不过上一张牌

直接点击 [过牌] 按钮
  ↓
视觉反馈: [过牌] 按钮变灰，牌回到原位
  ↓
系统处理: 将出牌权转给下一玩家
  ↓
下一轮: 玩家B出牌...
```

---

### 3.2 手机版 - 游戏进行界面

#### 3.2.1 竖屏布局 (推荐)

```
┌──────────────────────────────┐
│ 房间123456 底注20 第1/3局      │ (顶部信息)
├──────────────────────────────┤
│                              │
│  玩家2: Lv12 | 11张 [已过]    │ (上)
│                              │
├──────────────────────────────┤
│ 玩家1: 出顺 ♠3♠4♠5♠6♠7      │ (中上)
│ 玩家2: [过]   玩家3: [过]    │
│                              │
│ 现在你选择:                   │
│  [压牌]      [过牌]          │
│  [提示]      [表情]          │
├──────────────────────────────┤
│ 倒计时: 22秒 █████████░░░     │
├──────────────────────────────┤
│ 你的手牌 (12张):             │
│                              │
│ ♠A ♠K ♠Q ♠J ♠10            │
│ ♠9 ♠8 ♠7 ♠6 ♠5             │
│ ♣4 ♦3                       │
│                              │
│ [长按查看] [牌型分类]         │
└──────────────────────────────┘
```

**关键差异** (vs Web版):
- [ ] 单列显示，从上到下流动
- [ ] 玩家卡片简化为文本行
- [ ] 中央牌面放大，易于阅读
- [ ] 手牌显示为横向滚动条 (可左右滑动)
- [ ] 按钮为2×2网格，大且易点击

#### 3.2.2 横屏布局 (可选)

```
┌────────────────────────────────────────────┐
│ 房间:123456 底注:20 第1/3局                  │
├────────────────────────────────────────────┤
│                                            │
│  玩家2           │        玩家3             │
│  Lv12 11张      │        Lv10 8张         │
│  [已过]         │        [已过]           │
│                 │                         │
│  ┌─────────────────────────────┐          │
│  │ 当前: 玩家1 出顺                │          │
│  │ ♠3 ♠4 ♠5 ♠6 ♠7            │          │
│  │ 已过: 玩家2  已过: 玩家3      │          │
│  │                             │          │
│  │ 你的选择:                     │          │
│  │ [压牌] [过牌] [提示]          │          │
│  └─────────────────────────────┘          │
│  倒计时: 22秒 ██████░░░                   │
│                                            │
│  玩家1 Lv15      │        玩家4(你)         │
│  9张 已出5组     │        12张 当前可出     │
│                                            │
├────────────────────────────────────────────┤
│ 你的手牌: ♠A ♠K ♠Q ♠J ♠10 ♠9 ♠8 ...   │
│          (左右滚动)  [长按放大]            │
│                                            │
│ [快速表情] ☺️ 😂 😱 👏 💪               │
└────────────────────────────────────────────┘
```

**横屏优势**:
- ✓ 手牌显示更清晰
- ✓ 玩家位置更直观
- ✓ 可显示更多游戏历史

---

## 4. 游戏中的特殊场景

### 4.1 "接风" 场景 (对家获得出牌权)

**场景**: 玩家1出完最后一张牌，其他3人都过

**视觉反馈**:
```
┌────────────────────────────────────────┐
│                                        │
│  玩家1 (对家: 玩家3) 的最后一张: 对2  │
│                                        │
│  玩家2: 过      玩家3: 过              │
│  玩家4: 过                              │
│                                        │
│  🔥 接风! 玩家3 (你的对家) 获得出牌权 │
│                                        │
│  ✨ 玩家3 (对家) 现在可以先出牌!      │
│                                        │
│  [继续游戏]                            │
│                                        │
└────────────────────────────────────────┘
```

**游戏流程**:
1. 玩家1出完最后一张牌 (对2)
2. 玩家2、3、4都过 (无人压)
3. 系统检测到"接风"
4. 出牌权转给玩家3 (对家)
5. 玩家3可立即出任意新牌型

---

### 4.2 "抗贡" 场景 (输家拒绝进贡)

**场景**: 游戏结束，输家有2张大王

```
游戏结束排名:
  头游: 玩家1 (赢家)
  二游: 玩家2 (赢家)
  三游: 玩家3
  末游: 玩家4 (输家) ← 有2张大王

进贡提示:
╔══════════════════════════════════╗
║  玩家4 (末游) 需要进贡            ║
║  (除主牌红桃5外的最大牌)         ║
║                                  ║
║  检测到: 玩家4 有2张大王 🃏🃏   ║
║                                  ║
║  选择:                            ║
║  [进贡]          [抗贡]          ║
║ (交出最大牌)  (拒绝进贡)        ║
╚══════════════════════════════════╝
```

**抗贡后的效果**:
```
抗贡成功!

结果:
  ❌ 进贡: 取消
  ✅ 赢家必须先出牌 (下一局)
  ✅ 输家(你)获得出牌权优势

动画: 大王飞回玩家4的手中
```

---

### 4.3 升级提示

**升级1级**:
```
╔══════════════════════════════╗
║                              ║
║  🎉 恭喜升级! 🎉             ║
║                              ║
║  从 3级 → 4级                │
║                              ║
║  理由: 头游+二游/未抓人       │
║  下局打 4 级                  │
║                              ║
║  [继续游戏]                   ║
║                              ║
╚══════════════════════════════╝
```

**升级3级** (双下):
```
╔══════════════════════════════╗
║                              ║
║  🚀 连升3级! 🚀              ║
║                              ║
║  从 7级 → 10级               │
║                              ║
║  理由: 双下 (两个末游)       │
║  下局打 10 级                 ║
║                              ║
║  [继续游戏]                   ║
║                              ║
╚══════════════════════════════╝
```

**A级失败倒退**:
```
╔══════════════════════════════╗
║                              ║
║  ❌ 打A失败                   ║
║                              ║
║  连续3次失败: 同伴都是末游    ║
║  倒退: A级 → 2级              │
║                              ║
║  请调整策略，下局重新开始     │
║                              ║
║  [继续游戏]                   ║
║                              ║
╚══════════════════════════════╝
```

---

## 5. 游戏结算页面

### 5.1 Web 版 - 结算页

```
╔════════════════════════════════════════════════════════════╗
║                  【 本局游戏结束 】                        ║
║                   第1局 / 3局                             ║
╠════════════════════════════════════════════════════════════╣
║                                                            ║
║  最终排名:                                                ║
║                                                            ║
║  🥇 头游 (赢家)                                           ║
║  ┌──────────────────────────────────────────────────┐    ║
║  │ 玩家1 (Lv15)                    + 80 金币         │    ║
║  │ 出牌: 6次  压牌: 3次  最后一张: 对2              │    ║
║  └──────────────────────────────────────────────────┘    ║
║                                                            ║
║  🥈 二游 (赢家)                                           ║
║  ┌──────────────────────────────────────────────────┐    ║
║  │ 玩家2 (Lv12)                    + 40 金币         │    ║
║  │ 出牌: 5次  压牌: 2次  剩余: 0张                  │    ║
║  └──────────────────────────────────────────────────┘    ║
║                                                            ║
║  🥉 三游                                                 ║
║  ┌──────────────────────────────────────────────────┐    ║
║  │ 玩家3 (Lv10)                    - 20 金币         │    ║
║  │ 出牌: 4次  压牌: 1次  剩余: 2张                  │    ║
║  └──────────────────────────────────────────────────┘    ║
║                                                            ║
║  👤 末游 (输家)                                           ║
║  ┌──────────────────────────────────────────────────┐    ║
║  │ 玩家4 (你) (Lv14)                - 100 金币       │    ║
║  │ 出牌: 3次  压牌: 1次  剩余: 5张                  │    ║
║  │ 进贡: 对K → 还贡: 5                              │    ║
║  └──────────────────────────────────────────────────┘    ║
║                                                            ║
║  本局升级: 玩家1 升级 (3级 → 4级)                        ║
║                                                            ║
║  场景统计:                                                ║
║  ├─ 最大炸弹: 玩家1 (四张A)                              ║
║  ├─ 最长顺子: 玩家2 (7张顺)                              ║
║  ├─ 最多过牌: 玩家4 (8次)                               ║
║  └─ 最快出牌: 玩家1 (avg 3s)                            ║
║                                                            ║
║         [再来一局]    [返回大厅]    [分享战绩]           ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

### 5.2 手机版 - 结算页

```
┌──────────────────────────────┐
│ 本局游戏结束                  │
│ 第1局/3局                    │
├──────────────────────────────┤
│                              │
│ 🥇 头游: 玩家1               │
│    + 80 金币  Lv15          │
│    出牌:6 压牌:3            │
│                              │
│ 🥈 二游: 玩家2               │
│    + 40 金币  Lv12          │
│    出牌:5 压牌:2            │
│                              │
│ 🥉 三游: 玩家3               │
│    - 20 金币  Lv10          │
│    出牌:4 压牌:1            │
│                              │
│ 👤 末游: 你                   │
│    - 100 金币  Lv14         │
│    出牌:3 压牌:1            │
│    [进贡K→还贡5]             │
│                              │
│ 升级: 玩家1 (3→4级)         │
│                              │
│ 最佳统计:                     │
│ 最大炸: 玩家1 (4A)          │
│ 最长顺: 玩家2 (7张)         │
│ 最多过: 你 (8次)            │
│                              │
│ [再来一局]                   │
│ [返回大厅]                   │
│ [分享战绩]                   │
│                              │
└──────────────────────────────┘
```

---

## 6. 游戏提示与帮助系统

### 6.1 牌型识别提示

**场景**: 玩家点击 [提示] 按钮

```
系统分析你的手牌，推荐出牌

当前局面: 对方出了顺子 5-6-7-8-9

推荐方案 (按优先级):
  
  方案1: 出顺子 7-8-9-10-J ✅ (最优)
  理由: 比对方顺子大，且不浪费大牌
  
  方案2: 出顺子 6-7-8-9-10 (可行)
  理由: 也能压过
  
  方案3: 出顺子 9-10-J-Q-K (可行但不推荐)
  理由: 浪费了大牌
  
  不推荐: 过牌
  理由: 你有更好的出牌选择

[采用方案1]  [查看其他方案]  [我有更好的想法]
```

### 6.2 游戏规则帮助

**快速查询**:

```
╔════════════════════════════════╗
║ 掼蛋规则速查                  ║
├────────────────────────────────┤
║ 🎴 牌型说明                    ║
║ ├─ 顺子: 连续5张或以上单牌    ║
║ ├─ 炸弹: 4张或以上同数值     ║
║ ├─ 三带二: 3张+2张牌        ║
║ └─ 更多...                    ║
║                              ║
║ 📋 游戏规则                    ║
║ ├─ 如何出牌?                  ║
║ ├─ 什么是接风?                ║
║ ├─ 如何升级?                  ║
║ └─ 更多...                    ║
║                              ║
║ ⚡ 快速开始                    ║
║ └─ 新手教程 (5分钟)           ║
║                              ║
╚════════════════════════════════╝
```

---

## 7. 游戏页面流程图 (完整)

### 7.1 出牌阶段流程

```
┌─ 轮到你出牌 ─────────────────────────────────┐
│                                              │
│  【 你的选择 】                               │
│                                              │
│  ┌──────────────┐        ┌──────────────┐   │
│  │ 压牌          │        │  过牌         │   │
│  │ (跟大)       │        │  (放弃)       │   │
│  └──────────────┘        └──────────────┘   │
│        │                        │            │
│        ▼                        ▼            │
│  选择手牌       自动转向         │            │
│  组成有效牌型   下一玩家         │            │
│        │                        │            │
│        ├─ 有效? ▶ 出牌成功      │            │
│        │        │              │            │
│        │        ▼              ▼            │
│        │    下家选择 ───── 下家过牌或压牌   │
│        │        │                          │
│        └─ 无效? ▶ 错误提示                 │
│            (重新选择)                      │
│                                            │
└────────────────────────────────────────────┘

【 一轮结束条件 】

所有人都过? ──Yes──▶ 出牌者继续出牌
      ▲
      │
      No (有人压牌)
      │
      ▼
  轮到压牌者出新牌型
```

### 7.2 游戏进行完整时间线

```
时间轴
│
├─ T0:00 ── 玩家1 出 ♠5-6-7-8-9 (顺子)
│
├─ T0:05 ── 玩家2 过 [1秒思考]
│
├─ T0:08 ── 玩家3 压 ♠7-8-9-10-J (顺子)
│
├─ T0:15 ── 玩家4 过
│
├─ T0:18 ── 玩家1 过
│
├─ T0:22 ── 【 一轮结束 】玩家3赢了这轮
│           (所有人都过 玩家3的牌 无人压)
│
├─ T0:25 ── 玩家3 出 ♠♠ (对子)
│
├─ T0:30 ── 玩家4 压 ♣♣ (更大的对子)
│
├─ T0:40 ── 所有人都过
│
├─ T0:45 ── 【 玩家4 出完最后一张牌 】
│           【 头游确定: 玩家4 】
│
├─ T0:50 ── 【 玩家1 出完 】
│           【 二游确定: 玩家1 】
│
├─ T1:00 ── 【 玩家2 出完 】
│           【 三游确定: 玩家2 】
│
├─ T1:10 ── 【 玩家3 还有2张牌 】
│           【 末游确定: 玩家3 】
│
├─ T1:15 ── 【 游戏结束 】结算开始
│           ├─ 进贡计算
│           ├─ 金币分配
│           └─ 升级判定
│
├─ T1:30 ── 【 结算完成 】显示结果页
│
└─ T1:45 ── 玩家选择 [再来一局] 或 [返回]
```

---

## 8. 响应式设计 (Web vs Mobile)

### 8.1 断点设定

| 设备 | 宽度 | 布局 | 特点 |
|------|------|------|------|
| **手机竖屏** | <600px | 单列纵向 | 优先 |
| **手机横屏** | 600-900px | 双列 | 可选 |
| **平板** | 900-1200px | 三列 | 可选 |
| **桌面** | >1200px | 四列布局 | Web版 |

### 8.2 手机响应式关键点

```
竖屏 (推荐宽度优先)
├─ 顶部: 房间信息 (完整显示)
├─ 中央: 牌面区 (放大显示)
├─ 操作: 大按钮 (44px ≥)
└─ 手牌: 横向滚动

横屏 (可选支持)
├─ 左侧: 玩家信息
├─ 中央: 牌面区
├─ 右侧: 手牌
└─ 下方: 操作按钮
```

---

## 9. 动画与视觉效果

### 9.1 出牌动画

**牌从手牌区飞到中央**:

```
Timeline: 0.5秒

T0.0s: 卡片在手牌区 (起点)
       └─ 从底部向上移动

T0.2s: 卡片开始飞向中央
       └─ 抛物线运动 (贝塞尔曲线)
       └─ 逐渐放大 (从80% → 120%)
       └─ 旋转 360度

T0.4s: 卡片在中央附近
       └─ 缓速降落

T0.5s: 卡片落在中央
       └─ 轻微反弹动画
       └─ 声效: "啪" 的声音

结果: 手牌数量 -1
```

### 9.2 过牌动画

```
Timeline: 0.3秒

T0.0s: 你点击 [过牌]

T0.1s: [过牌] 按钮变灰并缩小
       └─ 声效: "嗖" 的声音

T0.2s: 界面显示 "玩家X 过牌" 提示
       └─ 提示从屏幕上方下降

T0.3s: 转向下一玩家
       └─ 焦点转移到下一玩家
       └─ 倒计时重置
```

### 9.3 升级动画

```
Timeline: 2秒

T0.0s: 游戏结束排名确定

T0.3s: 升级提示框出现
       └─ 从中央放大进入 (scale 0 → 1)
       └─ 背景模糊化

T0.5s: 显示升级内容
       └─ "从3级升到4级"
       └─ 显示理由
       └─ 金币动画加入

T1.0s: 金币数字动画
       └─ 从0 → +80 (数字动画计数)
       └─ 金币图标闪烁

T1.5s: 显示 [继续游戏] 按钮

T2.0s: 用户可交互
```

---

## 10. 性能优化要点

### 10.1 Web 版性能目标

| 指标 | 目标 | 方案 |
|------|------|------|
| **首屏加载** | <2s | 代码分割、懒加载 |
| **出牌响应** | <100ms | 预计算、缓存 |
| **帧率** | 60 FPS | GPU加速、减少DOM操作 |
| **内存占用** | <50MB | 对象池、及时GC |

### 10.2 手机版性能目标

| 指标 | 目标 | 方案 |
|------|------|------|
| **首屏加载** | <2s | 资源优化、预连接 |
| **滑动流畅度** | 60 FPS | 虚拟列表、减少重排 |
| **电池消耗** | 正常使用2-3小时 | 限制刷新率、优化事件 |
| **内存占用** | <100MB | 及时清理、图片优化 |

---

## 11. 无障碍设计 (Accessibility)

### 11.1 Web 版

- [ ] 所有按钮有明确的文本标签
- [ ] 色彩对比度 ≥4.5:1 (正常文本)
- [ ] 支持键盘导航 (Tab、Enter、Space)
- [ ] 屏幕阅读器兼容 (ARIA标签)
- [ ] 焦点指示器清晰可见

### 11.2 手机版

- [ ] 按钮最小尺寸 44px × 44px
- [ ] 文字大小 ≥14px
- [ ] 触摸目标间距 ≥8px
- [ ] 支持系统暗黑模式
- [ ] VoiceOver/TalkBack 兼容

---

## 12. 错误处理与提示

### 12.1 常见错误提示

```
❌ 网络连接丢失
   "检测到网络断开，正在重新连接..."
   [重试]  [返回大厅]

❌ 出牌无效
   "你选择的 5 张牌无法组成有效的顺子"
   "提示: 缺少 9♠"
   [明白了]

❌ 出牌超时
   "你已超时，自动过牌"
   (由系统自动过牌)

⚠️  服务器过载
   "服务器繁忙，可能出现延迟"
   [确定]
```

### 12.2 成功反馈

```
✅ 出牌成功
   "你出了顺子 5♠-6♠-7♠-8♠-9♠"
   (牌面中央显示，声效提示)

✅ 升级成功
   "恭喜升级！ 3级 → 4级"
   (炫彩动画，金币特效)

✅ 游戏结束
   "游戏结束，你是末游"
   (淡色进度条，等待结算)
```

---

## 13. 声效设计

| 场景 | 声效 | 时长 | 音量 |
|------|------|------|------|
| **出牌** | 清脆"啪"声 | 0.2s | 60% |
| **压牌** | 低音"哗"声 | 0.3s | 70% |
| **过牌** | 轻音"嗖"声 | 0.2s | 50% |
| **升级** | 欢快音效 | 1.5s | 80% |
| **游戏结束** | 胜利/失败音乐 | 2s | 70% |
| **倒计时** | 秒数提示音 | 0.1s | 40% |
| **出错** | 错误蜂鸣音 | 0.3s | 60% |

---

## 14. 测试场景清单

### 14.1 功能测试

- [ ] 正常出牌流程 (5张顺子)
- [ ] 使用逢人配出牌
- [ ] 过牌正常处理
- [ ] 接风逻辑触发
- [ ] 抗贡流程
- [ ] 升级计算 (升1/2/3级)
- [ ] A级特殊处理
- [ ] 倒计时超时自动过牌

### 14.2 UI/UX测试

- [ ] 响应式布局 (Web/Mobile/Tablet)
- [ ] 手机横屏/竖屏切换
- [ ] 动画流畅度 (60 FPS)
- [ ] 按钮易用性 (大小、可点击)
- [ ] 文字可读性 (对比度、大小)

### 14.3 性能测试

- [ ] 首屏加载 <2s
- [ ] 出牌响应 <100ms
- [ ] 内存占用 <50MB (Web)
- [ ] 长时间游戏 (无内存泄漏)

---

## 15. 与Spec Kit的集成建议

这份文档可直接用于 Spec Kit 工作流:

```
Step 1: /speckit.specify
  └─ 输入: 本文档中的 "1.1 完整用户旅程"

Step 2: /speckit.clarify
  └─ 澄清: 游戏规则、出牌逻辑、升级机制

Step 3: /speckit.plan
  └─ 技术方案: React/Vue + WebSocket + Canvas 渲染

Step 4: /speckit.tasks
  └─ 任务: 页面开发、动画实现、性能优化

Step 5: /speckit.implement
  └─ 代码: 实际开发和集成
```

---

**文档版本**: v1.0  
**创建日期**: 2025年12月12日  
**审核状态**: 待产品和设计评审  
**下一步**: UI/UX 设计稿绘制、原型验证  
