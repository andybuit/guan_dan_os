# 掼蛋游戏规则 - 完整版 (修订)

## 基础信息

**使用牌数**: 2副扑克牌 = 108张牌
- 牌点: 2, 3, 4, 5, 6, 7, 8, 9, 10, J, Q, K, A (每个点数4张)
- 王牌: 大王 × 2, 小王 × 2 (共4张)

**玩家数**: 4人 (两对对打)
- 分组: 南北一对 vs 东西一对
- 对家既是队友也是敌人

**级数**: 2 → 3 → 4 → ... → K → A
- **2 不必打** (从3级开始)
- **A 必打** (且需满足特定条件才算打过)

---

## 牌型大小关系 (完整版)

### 第1层: 天炸 (无敌)

**四王** (4张王牌)
- 4张大王 = 4张小王 = 2张大王+2张小王
- 什么牌型都能压
- 最大的牌

### 第2层: 炸弹 (次强)

按顺序从大到小:
1. **八张及以上炸弹** (8、7、6、5、4张同数值)
   - 如: 8张3、8张4等
   - 张数越多越大

2. **同花顺** (同花的5张连续牌)
   - 最大: ♠10-J-Q-K-A (同花顺1)
   - 最小: ♠A-2-3-4-5 (同花顺2)
   - 不分花色大小

3. **五张及以上炸弹**
   - 如: 5张3、5张4等

4. **四张炸弹**
   - 如: 4张3、4张4等

### 第3层: 普通牌型 (需同型比大小)

| 牌型 | 说明 | 最大例 | 最小例 |
|------|------|--------|--------|
| **三连对** | 3对连续对牌 | AAKKQQ | AA2233 |
| **钢板/滚筒** (三顺) | 2个连续三张 | 444555 | 333444 |
| **顺子** | 5张连续单牌 | 10-J-Q-K-A | A-2-3-4-5 |
| **三带二** (葫芦) | 3张+2张 | 333AA (三大) | 333AA (二大) |
| **三连张** | 2个连续三张 (不足2个不算) | 444555 | 333444 |
| **三张** (三同张) | 3张同数值 | AAA | 222 |
| **三连对** | 3对连续 | AAKKQQ | AA2233 |
| **对牌** | 2张同数值 | AA | 22 |
| **单牌** | 1张 | A | 2 |

### 牌型比较原则

1. **同牌型**才能比较
   - 顺子只能跟顺子
   - 对牌只能跟对牌
   - 三张只能跟三张

2. **A的特殊性**:
   - 在搭配三连对、二连三、顺子、同花顺时，A可作1
   - 示例: A-2-3-4-5 (顺子，A作1) vs 6-7-8-9-10

3. **不分花色**:
   - 顺子、对牌等都不分花色
   - 只有同花顺分花色

---

## 核心规则

### 规则1: 主牌与逢人配

**主牌设定**:
- 每局开始时确定一个"主牌" (如打3级时，主牌为3)
- 主牌的**红桃两张**称为"逢人配"
- 例: 主牌为3，则红桃3（2张）为逢人配

**逢人配的用途**:
- 可代替除大小王以外的任意牌
- 灵活组合成多张炸弹、同花顺等任意牌型
- 与两张牌配成三带二时，出牌时需说明当大牌或小牌

**示例**:
```
主牌: 5 (红桃5为逢人配)
手中牌: 2-3-4-红桃5-6
可以组成: 2-3-4-5-6 (顺子)
```

### 规则2: 出牌顺序与回合

**首先出牌的确定**:
- 第一轮: 由庄家或指定玩家开始
- 之后: 按出牌顺序 (顺时针或逆时针) 轮流出牌

**出牌规则**:
1. 首先出牌者可出任意牌型
2. 下家如果能压牌，可压牌
3. 如果压不了，则**过牌**

**压牌规则**:
- 只能出比上一张更大的牌
- 必须是**相同牌型**
- 例: 上家出对3，下家只能出更大的对子 (对4、对5等)

**接风规则** (重要):
- 如果某玩家的最后一张牌打出，其他3人都管不了（压不了）
- 则该玩家的**对家**可获得出牌权
- 即: 对家可以先出牌 (不按顺序)

### 规则3: 一轮的结束

一轮出牌结束的条件:
- 当前出牌者打出一张牌后
- **其他3人都过牌**（无人压）
- 则出牌者再出一张牌，开启新的一轮

### 规则4: 游戏结束排名

**排名顺序**:
1. **头游** (上游): 最先出完所有牌
2. **二游**: 第2个出完所有牌
3. **三游**: 第3个出完所有牌
4. **末游** (下游): 最后一个出完或没出完所有牌

**特例**: 如果某玩家一张牌都没出，仍为末游

---

## 进贡与还贡 (赢家奖励)

### 双下情况 (两个输家)

**进贡规则**:
- 两个输家各向两个赢家进贡一张（除主牌红桃外的）**最大的牌**
- 赢家区分主次（上游取大牌）
- 赢家分别还一张**10以下**（含10）的任意牌

**抗贡条件**:
- 若进贡者有两张大王，可以**抗贡**
- 抗贡时: 由赢家先出牌

### 单下情况 (一个输家)

**进贡规则**:
- 输家向赢家进贡一张（除主牌红桃外的）**最大的牌**
- 赢家还一张**10以下**（含10）的任意牌

**抗贡条件**:
- 若输家有两张大王，可以**抗贡**
- 抗贡时: 由赢家先出牌

**先手权**:
- 若无抗贡: 输家先出牌（获得下一轮优势）

---

## 升级规则 (最复杂部分)

### 基本原则

**只有赢家（头游）才有升级资格**

### 升级情况表

| 赢家成绩 | 对方成绩 | 升级级数 | 说明 |
|---------|---------|--------|------|
| **头游+二游** | 两人都是末游 | **升3级** | 双下 |
| **头游+二游** | 对方一人末游 | **升2级** | 单下 |
| **头游+二游** | 对方都不是末游 | **升1级** | 未抓人 |
| **头游+三游** | 两人都是末游 | **升3级** | 双下 |
| **头游+三游** | 对方一人末游 | **升2级** | 单下 |
| **头游+三游** | 对方都不是末游 | **升1级** | 未抓人 |
| **头游+末游** | 对方是二游+三游 | **升1级** | 最弱情况 |

### 特殊规则: A级

**A级的特殊性**:
1. **A 必打**: 必须打这一级
2. **打A必须成功**: 
   - 需要**同伴是头游或二游或三游**（不能是末游）
   - 才算**打过A级**
3. **A级失败的处罚**:
   - 连续3局打A都失败（同伴都是末游）
   - 需要**倒退回2级**，重新开始

### 升级过程示例

```
开始: 打2级
一局后: 2级升到3级
再打一局: 3级升到4级或5级 (取决于成绩)
...
最终: 升到A级

打A级:
  ✅ 成功 (同伴是二游) → A级保持
  ❌ 失败1 (同伴是末游) → 继续打A
  ❌ 失败2 (同伴是末游) → 继续打A
  ❌ 失败3 (同伴是末游) → 倒退到2级
```

---

## 完整游戏流程

### 第0步: 准备阶段

```
1. 4人就位 (南北一对 vs 东西一对)
2. 洗牌 (打乱108张牌)
3. 发牌 (每人27张，共108张)
4. 确定"主牌" (本轮要打的级数)
5. 确定主牌的"逢人配" (红桃两张)
```

### 第1步: 首先出牌

```
庄家或指定玩家可出任意牌型
  ├─ 出单牌
  ├─ 出对牌
  ├─ 出三张
  ├─ 出顺子
  ├─ 出炸弹
  └─ 出其他牌型

示例: 出 5-6-7-8-9 (顺子)
```

### 第2步: 下家选择

```
下家有两个选择:

A. 压牌 (跟大)
   └─ 出比 5-6-7-8-9 更大的顺子
      (如: 7-8-9-10-J)

B. 过牌 (不跟)
   └─ 放弃出牌，到第3人

第3人和第4人同样选择，直到:
  ✅ 所有人都过 → 出牌者赢了这轮，继续出牌
  ❌ 有人压 → 出牌者过，轮到压牌者出
```

### 第3步: 一轮结束

```
某人压成功后，出牌权转给该人
该人可出任意新牌型
重复步骤2-3，直到有人出完所有牌
```

### 第4步: 结算

```
第一个出完 → 头游 (赢家)
第二个出完 → 二游
第三个出完 → 三游
最后没出完 → 末游 (输家)

进贡 (输家给赢家)
升级 (赢家升级)
记录成绩
```

---

## 常见特殊情况

### 情况1: "接风"

```
场景: 
  玩家A出完最后一张牌 (是个对2)
  玩家B: 过
  玩家C: 过
  玩家D: 过 (都压不了对2)

结果:
  ✅ 玩家A的对家（玩家C）获得出牌权
  ✅ 玩家C可立即出新牌型
  ❌ 其他玩家需要等C出完后才轮到
```

### 情况2: 抗贡

```
场景:
  赢家1要求输家进贡最大牌（如A）
  输家有2张大王

结果:
  ❌ 输家拒绝进贡，改为"抗贡"
  ✅ 赢家必须先出牌（下一轮）
  ✅ 输家可先出牌（获得优势）
```

### 情况3: 逢人配的多种用法

```
主牌: 7
逢人配: 红桃7（2张）

示例1: 组成三张
  手牌: 7-7-红桃7 = 三张7 ✅

示例2: 组成顺子
  手牌: 5-6-红桃7-8-9 = 5-6-7-8-9 ✅

示例3: 组成炸弹
  手牌: 8-8-红桃7-8 = 四张8 ✅

示例4: 组成三带二
  手牌: 3-3-3-红桃7-红桃7 
  可以说作"大三带" (三大) 或 "小三带" (二大) ✅
```

### 情况4: 级数中的A特殊性

```
打A级时的顺子比较:

场景: A-2-3-4-5 vs 6-7-8-9-10

两者都是顺子
  A-2-3-4-5 (A作1，最小)
  vs
  6-7-8-9-10 (中等大小)
  
✅ 6-7-8-9-10 更大，压过 A-2-3-4-5
```

---

## 术语速查表

| 术语 | 说明 |
|------|------|
| **头游** | 最先出完所有牌的人 (赢家) |
| **二游** | 第2个出完所有牌 |
| **三游** | 第3个出完所有牌 |
| **末游** | 最后一个出完或未出完 (输家) |
| **逢人配** | 主牌的红桃两张，可代替任意非王牌 |
| **接风** | 对家可以获得出牌权（当前出牌者最后一张无人压） |
| **抗贡** | 输家有2张大王时可拒绝进贡 |
| **进贡** | 输家向赢家交出最大牌 |
| **还贡** | 赢家返还给输家一张小牌（≤10） |
| **双下** | 结对的两家都是末游 |
| **单下** | 结对的一家是末游 |
| **打A** | 当级数推进到A级 (最高级) |

---

## 与原MVP文档的主要纠正

### ❌ 原文错误部分

1. **底牌机制** ❌
   - 原文: "预留2张牌作为底牌"
   - 正确: 掼蛋使用108张牌，4人各27张，**无底牌**

2. **牌型识别** ❌
   - 原文: 列举了8种牌型
   - 正确: 应有**9-10种**牌型，包括"三带二"(葫芦)

3. **升级规则** ❌
   - 原文: 简化为 "末位压级，首位升级"
   - 正确: 复杂的升1/2/3级机制，取决于双下/单下

4. **A级处理** ❌
   - 原文: 未提及
   - 正确: **A必打，且需同伴非末游才算打过；连3次失败倒退回2**

5. **逢人配** ❌
   - 原文: 未提及
   - 正确: 主牌红桃两张可**代替任意非王牌**，是重要的策略工具

### ✅ 更新后的正确版本

✓ 108张牌 (2副)
✓ 无底牌机制
✓ 9种主要牌型 + 4种王牌
✓ 复杂升级系统 (升1/2/3级)
✓ A级特殊规则
✓ 逢人配灵活应用
✓ 接风规则
✓ 抗贡机制

---

## 对MVP功能的影响

### 需要重新设计的部分

#### 1. 游戏引擎 (牌型识别)

```javascript
// 原来只需识别8种，现在需要:
enum CardType {
  FOUR_KINGS,              // 四王
  EIGHT_PLUS_BOMB,        // 8张及以上炸弹
  SAME_SUIT_STRAIGHT,     // 同花顺
  FIVE_PLUS_BOMB,         // 5张及以上炸弹
  FOUR_BOMB,              // 4张炸弹
  THREE_PAIR_STRAIGHT,    // 三连对
  ROLLER,                 // 钢板/滚筒 (三顺)
  STRAIGHT,               // 顺子
  THREE_WITH_TWO,         // 三带二 (葫芦)
  THREE_STRAIGHT,         // 三连张
  THREE,                  // 三张
  PAIR,                   // 对牌
  SINGLE,                 // 单牌
}
```

#### 2. 升级计算逻辑

```javascript
// 原来简单的升1级，现在需要:
function calculateUpgrade(
  myTeamRanks: Rank[],      // [头游, 二游] 或 [头游, 三游]
  oppTeamRanks: Rank[]      // 对方的排名
): number {
  // 判断是否双下/单下/未抓人
  // 返回升1/2/3级
  // 特殊处理A级
}
```

#### 3. 出牌验证

```javascript
// 需要加入逢人配验证:
function isValidPlay(
  cards: Card[],
  previousPlay: Card[],
  wildcards: Card[]  // 逢人配的红桃两张
): boolean {
  // 检查是否能压
  // 考虑逢人配的灵活替换
}
```

#### 4. 接风逻辑

```javascript
// 新增接风检测:
function detectJiefeng(
  playedCards: Card[],
  otherPlayersCanPlay: boolean[]
): boolean {
  // 如果最后一张牌无人压
  // 对家可获得出牌权
}
```

---

## 推荐资源

### 学习掼蛋的最佳方式

1. **官方规则**: 参考竞技掼蛋规则文档 (体育总局版本)
2. **视频教程**: 搜索 "掼蛋规则详解" (多个讲解版本)
3. **实际体验**: 下载掼蛋APP体验真实游戏
4. **社区讨论**: 掼蛋论坛、微信群交流

---

**本文档版本**: v2.0 (已更正)  
**更新日期**: 2025年12月12日  
**准确性**: 基于官方竞技掼蛋规则 + 体育总局标准
